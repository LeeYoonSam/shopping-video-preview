---
id: SPEC-HOVER-POPUP-001
version: "1.0.0"
status: "draft"
created: "2025-12-23"
updated: "2025-12-23"
author: "MoAI-ADK"
priority: "MEDIUM"
tags: ["frontend", "ui-component", "video", "hover", "popup"]
dependency: "SPEC-VIDEOGEN-001"
---

# SPEC-HOVER-POPUP-001: 상품 호버 비디오 팝업 UI 컴포넌트

## HISTORY

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|-----------|
| 1.0.0 | 2025-12-23 | MoAI-ADK | 초기 SPEC 작성 |

---

## 개요 (Overview)

### 목적

상품 목록에서 사용자가 상품 이미지 위에 마우스를 올리면 해당 상품의 착용 비디오가 팝업으로 표시되어 자동 재생되는 인터랙티브 UI 컴포넌트를 구현한다.

### 배경

- 이커머스 환경에서 정적 이미지만으로는 상품의 실제 모습을 전달하기 어려움
- 비디오를 통한 상품 미리보기가 구매 전환율을 향상시킴
- 사용자 경험을 방해하지 않으면서 자연스러운 비디오 제공 필요

### 범위

- 상품 카드 호버 이벤트 감지 및 처리
- 비디오 팝업 UI 컴포넌트 구현
- 애니메이션 및 트랜지션 효과
- 비디오 자동 재생 및 제어
- 반응형 디자인 및 모바일 대응
- 접근성 지원

---

## EARS 요구사항

### 1. Ubiquitous (보편적 요구사항)

| ID | 요구사항 |
|----|----------|
| U-001 | 시스템은 모든 상품 카드에서 호버 시 비디오 팝업 기능을 제공해야 한다. |
| U-002 | 비디오 팝업은 항상 음소거 상태로 자동 재생되어야 한다. |
| U-003 | 팝업은 뷰포트 경계를 벗어나지 않도록 자동으로 위치가 조정되어야 한다. |
| U-004 | 비디오 재생 중 로딩 상태는 스켈레톤 UI로 표시되어야 한다. |
| U-005 | 팝업 컴포넌트는 React Portal을 사용하여 DOM 계층 외부에 렌더링되어야 한다. |

### 2. Event-driven (이벤트 기반 요구사항)

| ID | 이벤트 | 시스템 반응 |
|----|--------|-------------|
| E-001 | 사용자가 상품 카드 위에 마우스를 300ms 이상 유지하면 | 시스템은 비디오 팝업을 표시해야 한다. |
| E-002 | 사용자가 상품 카드에서 마우스를 벗어나면 | 시스템은 비디오 팝업을 숨기고 비디오 재생을 중지해야 한다. |
| E-003 | 사용자가 팝업 내 음소거 해제 버튼을 클릭하면 | 시스템은 비디오 음소거를 해제해야 한다. |
| E-004 | 모바일에서 사용자가 상품 카드를 탭하면 | 시스템은 비디오 팝업을 토글해야 한다. |
| E-005 | 키보드 사용자가 상품 카드에 포커스하고 Enter 키를 누르면 | 시스템은 비디오 팝업을 표시해야 한다. |
| E-006 | 키보드 사용자가 Escape 키를 누르면 | 시스템은 현재 표시된 비디오 팝업을 닫아야 한다. |

### 3. Unwanted Behavior (원치 않는 동작 방지)

| ID | 조건 | 시스템 반응 |
|----|------|-------------|
| UW-001 | 만약 비디오 로딩이 3초 이내에 완료되지 않으면 | 시스템은 로딩 스켈레톤 대신 정적 이미지를 표시해야 한다. |
| UW-002 | 만약 비디오 URL이 유효하지 않으면 | 시스템은 에러 상태를 표시하고 기본 상품 이미지로 폴백해야 한다. |
| UW-003 | 만약 네트워크 연결이 불안정하면 | 시스템은 버퍼링 인디케이터를 표시해야 한다. |
| UW-004 | 만약 사용자가 빠르게 여러 상품 카드를 호버하면 | 시스템은 마지막 호버된 상품의 팝업만 표시해야 한다. |
| UW-005 | 만약 뷰포트가 팝업을 표시하기에 충분하지 않으면 | 시스템은 팝업 크기를 축소하거나 숨겨야 한다. |

### 4. State-driven (상태 기반 요구사항)

| ID | 상태 조건 | 시스템 동작 |
|----|-----------|-------------|
| S-001 | 팝업이 "표시 중" 상태인 동안 | 시스템은 다른 상품 카드의 호버 이벤트를 무시해야 한다. |
| S-002 | 비디오가 "재생 중" 상태인 동안 | 시스템은 재생 진행 표시줄을 업데이트해야 한다. |
| S-003 | 비디오가 "버퍼링" 상태인 동안 | 시스템은 로딩 스피너를 표시해야 한다. |
| S-004 | 팝업이 "닫히는 중" 애니메이션 상태인 동안 | 시스템은 새로운 팝업 열기 요청을 대기열에 추가해야 한다. |
| S-005 | 시스템이 "오프라인" 상태인 동안 | 시스템은 캐시된 비디오만 재생해야 한다. |

### 5. Optional (선택적 요구사항)

| ID | 조건 | 시스템 동작 |
|----|------|-------------|
| O-001 | 사용자 설정에 따라 | 시스템은 팝업 비디오에 음소거 해제 버튼을 표시할 수 있어야 한다. |
| O-002 | 사용자 설정에 따라 | 시스템은 자동 재생을 비활성화하고 재생 버튼을 표시할 수 있어야 한다. |
| O-003 | 데이터 절약 모드가 활성화되면 | 시스템은 비디오 대신 GIF 썸네일을 표시할 수 있어야 한다. |
| O-004 | 사용자 설정에 따라 | 시스템은 호버 딜레이 시간을 조정할 수 있어야 한다. |
| O-005 | 접근성 설정에 따라 | 시스템은 reduced-motion 모드에서 애니메이션을 비활성화할 수 있어야 한다. |

---

## UI/UX 사양 (상세 디자인 스펙)

### 레이아웃 사양

| 속성 | 값 | 비고 |
|------|-----|------|
| 팝업 너비 | 320px | 모바일 우선 설계 |
| 팝업 높이 | 568px | 9:16 세로 영상 기준 |
| 팝업 모서리 반경 | 12px | 부드러운 모서리 |
| 팝업 그림자 | 0 8px 32px rgba(0,0,0,0.24) | 깊이감 표현 |
| 상품 카드와의 간격 | 16px | 충분한 시각적 분리 |

### 반응형 브레이크포인트

| 브레이크포인트 | 팝업 크기 | 동작 |
|----------------|-----------|------|
| 모바일 (< 640px) | 280x497px | 탭 인터랙션 |
| 태블릿 (640px - 1024px) | 300x533px | 호버/탭 혼합 |
| 데스크톱 (> 1024px) | 320x568px | 호버 인터랙션 |

### 애니메이션 사양

| 애니메이션 | 속성 | 값 |
|------------|------|-----|
| 팝업 나타남 | opacity | 0 -> 1 |
| | scale | 0.95 -> 1 |
| | duration | 200ms |
| | easing | ease-out |
| 팝업 사라짐 | opacity | 1 -> 0 |
| | scale | 1 -> 0.95 |
| | duration | 150ms |
| | easing | ease-in |

### 호버 딜레이

| 상황 | 딜레이 |
|------|--------|
| 팝업 표시 | 300ms |
| 팝업 숨김 | 100ms |
| 의도: 의도치 않은 팝업 방지 및 빠른 닫힘 |

### 색상 시스템

| 요소 | 라이트 모드 | 다크 모드 |
|------|-------------|-----------|
| 팝업 배경 | #FFFFFF | #1F2937 |
| 오버레이 | rgba(0,0,0,0.5) | rgba(0,0,0,0.7) |
| 컨트롤 버튼 | #374151 | #E5E7EB |
| 로딩 스켈레톤 | #E5E7EB | #374151 |

---

## 컴포넌트 구조 (Component Architecture)

### 컴포넌트 계층

```
ProductCard (상품 카드)
├── ProductImage (상품 이미지)
├── ProductInfo (상품 정보)
└── VideoPopupTrigger (팝업 트리거)
    └── [Portal]
        └── VideoPopup (비디오 팝업)
            ├── VideoPlayer (비디오 플레이어)
            │   ├── HLSPlayer (HLS 스트리밍)
            │   ├── VideoControls (재생 컨트롤)
            │   └── LoadingOverlay (로딩 오버레이)
            ├── PopupHeader (팝업 헤더)
            │   ├── ProductTitle (상품명)
            │   └── CloseButton (닫기 버튼)
            └── PopupFooter (팝업 푸터)
                ├── MuteToggle (음소거 토글)
                └── ProgressBar (진행 표시줄)
```

### 주요 컴포넌트 Props

#### VideoPopup

| Prop | 타입 | 필수 | 기본값 | 설명 |
|------|------|------|--------|------|
| videoUrl | string | Yes | - | HLS 비디오 URL |
| productId | string | Yes | - | 상품 ID |
| productTitle | string | Yes | - | 상품명 |
| thumbnailUrl | string | No | - | 폴백 썸네일 |
| isOpen | boolean | Yes | false | 팝업 표시 여부 |
| onClose | () => void | Yes | - | 닫기 콜백 |
| position | Position | No | auto | 팝업 위치 |
| aspectRatio | '9:16' \| '16:9' | No | '9:16' | 영상 비율 |

#### VideoPlayer

| Prop | 타입 | 필수 | 기본값 | 설명 |
|------|------|------|--------|------|
| src | string | Yes | - | 비디오 소스 URL |
| autoPlay | boolean | No | true | 자동 재생 |
| muted | boolean | No | true | 음소거 |
| loop | boolean | No | true | 반복 재생 |
| onLoadStart | () => void | No | - | 로딩 시작 콜백 |
| onLoadComplete | () => void | No | - | 로딩 완료 콜백 |
| onError | (error: Error) => void | No | - | 에러 콜백 |

### 상태 관리

#### 팝업 상태

| 상태 | 타입 | 설명 |
|------|------|------|
| isHovering | boolean | 호버 중 여부 |
| isPopupVisible | boolean | 팝업 표시 여부 |
| popupPosition | Position | 팝업 위치 좌표 |
| hoverTimeout | number \| null | 호버 딜레이 타이머 |

#### 비디오 상태

| 상태 | 타입 | 설명 |
|------|------|------|
| isLoading | boolean | 로딩 중 여부 |
| isPlaying | boolean | 재생 중 여부 |
| isBuffering | boolean | 버퍼링 중 여부 |
| isMuted | boolean | 음소거 여부 |
| progress | number | 재생 진행률 (0-100) |
| error | Error \| null | 에러 객체 |

---

## 접근성 요구사항 (Accessibility)

### WCAG 2.1 준수 사항

| 수준 | 항목 | 구현 방법 |
|------|------|-----------|
| A | 키보드 접근성 | Enter로 팝업 열기, Escape로 닫기 |
| A | 포커스 관리 | 팝업 열릴 때 포커스 이동, 닫힐 때 복원 |
| A | 대체 텍스트 | 비디오 설명 aria-label 제공 |
| AA | 색상 대비 | 4.5:1 이상의 대비율 |
| AA | 모션 감소 | prefers-reduced-motion 존중 |
| AAA | 확장 오디오 설명 | 비디오 캡션 지원 |

### 스크린 리더 지원

| 요소 | ARIA 속성 | 값 |
|------|-----------|-----|
| 팝업 컨테이너 | role | dialog |
| | aria-modal | true |
| | aria-labelledby | popup-title |
| 비디오 플레이어 | role | application |
| | aria-label | "{상품명} 미리보기 비디오" |
| 닫기 버튼 | aria-label | "비디오 팝업 닫기" |
| 음소거 토글 | aria-pressed | true/false |
| | aria-label | "음소거 토글" |

### 키보드 네비게이션

| 키 | 동작 |
|----|------|
| Tab | 상품 카드 간 이동 |
| Enter | 포커스된 상품의 팝업 열기 |
| Space | 비디오 재생/일시정지 |
| Escape | 팝업 닫기 |
| M | 음소거 토글 |
| Arrow Left/Right | 비디오 탐색 (선택적) |

---

## 의존성 (Dependencies)

### 필수 의존성

| 패키지 | 버전 | 용도 |
|--------|------|------|
| react | ^19.0.0 | UI 라이브러리 |
| next | ^15.0.0 | App Router, SSR |
| framer-motion | ^11.0.0 | 애니메이션 |
| hls.js | ^1.5.0 | HLS 비디오 스트리밍 |
| tailwindcss | ^3.4.0 | 스타일링 |

### SPEC 의존성

| SPEC ID | 관계 | 설명 |
|---------|------|------|
| SPEC-VIDEOGEN-001 | 필수 | 비디오 생성 API로부터 비디오 URL 수신 |

### 브라우저 지원

| 브라우저 | 최소 버전 | 비고 |
|----------|-----------|------|
| Chrome | 90+ | 완전 지원 |
| Firefox | 88+ | 완전 지원 |
| Safari | 14+ | HLS 네이티브 지원 |
| Edge | 90+ | 완전 지원 |
| Mobile Safari | 14+ | iOS HLS 지원 |
| Chrome Android | 90+ | HLS.js 사용 |

---

## 성능 요구사항

| 메트릭 | 목표값 | 측정 방법 |
|--------|--------|-----------|
| 팝업 표시 시간 | < 100ms | 호버 딜레이 제외 |
| 비디오 첫 프레임 | < 1초 | Time to First Frame |
| 메모리 사용량 | < 50MB | 팝업당 추가 메모리 |
| CPU 사용률 | < 10% | 비디오 재생 중 |
| 번들 크기 영향 | < 30KB | gzip 압축 후 |

---

## 보안 고려사항

| 항목 | 요구사항 |
|------|----------|
| 비디오 URL | HTTPS 필수 |
| CSP | media-src 정책 준수 |
| XSS 방지 | 동적 URL 검증 |
| 자동 재생 정책 | 브라우저 정책 준수 (음소거 필수) |

---

## 태그 (Traceability)

```
[SPEC-HOVER-POPUP-001]
├── [U-001] ~ [U-005]: 보편적 요구사항
├── [E-001] ~ [E-006]: 이벤트 기반 요구사항
├── [UW-001] ~ [UW-005]: 원치 않는 동작 방지
├── [S-001] ~ [S-005]: 상태 기반 요구사항
└── [O-001] ~ [O-005]: 선택적 요구사항
```
