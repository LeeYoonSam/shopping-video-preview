---
id: SPEC-HOVER-POPUP-001
type: acceptance-criteria
version: "1.0.0"
created: "2025-12-23"
updated: "2025-12-23"
spec_ref: "./spec.md"
plan_ref: "./plan.md"
---

# SPEC-HOVER-POPUP-001: 인수 기준서

## 태그 참조

```
[SPEC-HOVER-POPUP-001] > [ACCEPTANCE]
├── [AC-HOVER]: 호버 인터랙션 테스트
├── [AC-VIDEO]: 비디오 재생 테스트
├── [AC-UI]: UI/UX 테스트
├── [AC-A11Y]: 접근성 테스트
├── [AC-MOBILE]: 모바일 테스트
└── [AC-PERF]: 성능 테스트
```

---

## 테스트 시나리오

### 1. 호버 인터랙션 시나리오 [AC-HOVER]

#### 시나리오 1.1: 기본 호버 팝업 표시 [E-001]

```gherkin
Given 사용자가 상품 목록 페이지에 있다
  And 상품 카드에 비디오 URL이 연결되어 있다
When 사용자가 상품 카드 위에 마우스를 올린다
  And 300ms 이상 마우스를 유지한다
Then 비디오 팝업이 fade-in 애니메이션과 함께 표시된다
  And 비디오가 음소거 상태로 자동 재생된다
```

#### 시나리오 1.2: 빠른 호버 시 팝업 미표시 [UW-004]

```gherkin
Given 사용자가 상품 목록 페이지에 있다
When 사용자가 상품 카드 위에 마우스를 올린다
  And 200ms 후에 마우스를 카드에서 벗어난다
Then 비디오 팝업이 표시되지 않는다
```

#### 시나리오 1.3: 마우스 이탈 시 팝업 닫힘 [E-002]

```gherkin
Given 비디오 팝업이 표시되어 있다
  And 비디오가 재생 중이다
When 사용자가 상품 카드에서 마우스를 벗어난다
Then 비디오 팝업이 fade-out 애니메이션과 함께 사라진다
  And 비디오 재생이 중지된다
  And 비디오 리소스가 정리된다
```

#### 시나리오 1.4: 다른 상품 호버 시 팝업 전환 [S-001]

```gherkin
Given 상품 A의 비디오 팝업이 표시되어 있다
When 사용자가 상품 B 위에 마우스를 올린다
  And 300ms 이상 유지한다
Then 상품 A의 팝업이 먼저 닫힌다
  And 상품 B의 팝업이 표시된다
```

#### 시나리오 1.5: 연속 빠른 호버 [UW-004]

```gherkin
Given 사용자가 상품 목록 페이지에 있다
When 사용자가 여러 상품 카드 위를 빠르게 이동한다
Then 마지막으로 300ms 이상 머무른 상품의 팝업만 표시된다
  And 불필요한 팝업 깜빡임이 발생하지 않는다
```

---

### 2. 비디오 재생 시나리오 [AC-VIDEO]

#### 시나리오 2.1: 정상 비디오 재생 [U-002]

```gherkin
Given 사용자가 상품 카드를 호버했다
  And 비디오 팝업이 표시되었다
When 비디오 로딩이 완료된다
Then 비디오가 음소거 상태로 자동 재생된다
  And 비디오가 반복 재생된다
  And 재생 진행 표시줄이 업데이트된다
```

#### 시나리오 2.2: 비디오 로딩 중 표시 [U-004]

```gherkin
Given 사용자가 상품 카드를 호버했다
When 비디오 팝업이 표시된다
  And 비디오가 로딩 중이다
Then 스켈레톤 UI가 표시된다
  And 로딩 중임을 나타내는 애니메이션이 표시된다
```

#### 시나리오 2.3: 비디오 로딩 타임아웃 [UW-001]

```gherkin
Given 사용자가 상품 카드를 호버했다
  And 비디오 팝업이 표시되었다
When 비디오 로딩이 3초 이내에 완료되지 않는다
Then 로딩 스켈레톤 대신 상품 정적 이미지가 표시된다
  And "비디오를 불러올 수 없습니다" 메시지가 표시된다
```

#### 시나리오 2.4: 잘못된 비디오 URL [UW-002]

```gherkin
Given 상품의 비디오 URL이 유효하지 않다
When 사용자가 해당 상품 카드를 호버한다
Then 에러 상태 UI가 표시된다
  And 기본 상품 이미지가 표시된다
  And 에러 로그가 기록된다
```

#### 시나리오 2.5: 버퍼링 상태 표시 [UW-003]

```gherkin
Given 비디오가 재생 중이다
When 네트워크가 불안정해진다
  And 비디오 버퍼링이 발생한다
Then 버퍼링 인디케이터(스피너)가 표시된다
  And 버퍼링이 완료되면 재생이 재개된다
```

#### 시나리오 2.6: 음소거 해제 [E-003, O-001]

```gherkin
Given 비디오 팝업이 표시되어 있다
  And 음소거 해제 버튼이 활성화되어 있다
  And 비디오가 음소거 상태로 재생 중이다
When 사용자가 음소거 해제 버튼을 클릭한다
Then 비디오 음소거가 해제된다
  And 버튼 상태가 "음소거" 버튼으로 변경된다
```

---

### 3. UI/UX 시나리오 [AC-UI]

#### 시나리오 3.1: 팝업 위치 자동 조정 - 우측 [U-003]

```gherkin
Given 상품 카드가 화면 좌측에 위치해 있다
  And 우측에 팝업 표시 공간이 충분하다
When 사용자가 상품 카드를 호버한다
Then 비디오 팝업이 상품 카드 우측에 표시된다
  And 팝업과 카드 사이에 16px 간격이 있다
```

#### 시나리오 3.2: 팝업 위치 자동 조정 - 좌측 [U-003]

```gherkin
Given 상품 카드가 화면 우측 가장자리에 위치해 있다
  And 우측에 팝업 표시 공간이 부족하다
When 사용자가 상품 카드를 호버한다
Then 비디오 팝업이 상품 카드 좌측에 표시된다
  And 팝업이 뷰포트를 벗어나지 않는다
```

#### 시나리오 3.3: 팝업 수직 위치 조정 [UW-005]

```gherkin
Given 상품 카드가 화면 하단에 위치해 있다
  And 하단에 팝업 전체 표시 공간이 부족하다
When 사용자가 상품 카드를 호버한다
Then 팝업이 상단으로 정렬되어 표시된다
  And 팝업이 뷰포트 하단을 벗어나지 않는다
```

#### 시나리오 3.4: 애니메이션 동작 확인

```gherkin
Given 사용자가 상품 카드를 호버했다
When 팝업이 표시된다
Then 팝업이 opacity 0에서 1로 변화한다
  And 팝업이 scale 0.95에서 1로 변화한다
  And 전체 애니메이션이 200ms 동안 ease-out으로 진행된다

When 사용자가 상품 카드에서 마우스를 벗어난다
Then 팝업이 opacity 1에서 0으로 변화한다
  And 팝업이 scale 1에서 0.95로 변화한다
  And 전체 애니메이션이 150ms 동안 ease-in으로 진행된다
```

#### 시나리오 3.5: 다크 모드 지원

```gherkin
Given 시스템이 다크 모드로 설정되어 있다
When 비디오 팝업이 표시된다
Then 팝업 배경이 #1F2937 색상이다
  And 컨트롤 버튼이 #E5E7EB 색상이다
  And 모든 요소의 색상 대비가 4.5:1 이상이다
```

---

### 4. 접근성 시나리오 [AC-A11Y]

#### 시나리오 4.1: 키보드 팝업 열기 [E-005]

```gherkin
Given 사용자가 키보드로 탐색 중이다
  And 상품 카드에 포커스가 있다
When 사용자가 Enter 키를 누른다
Then 비디오 팝업이 표시된다
  And 포커스가 팝업 내부로 이동한다
  And 스크린 리더가 "비디오 팝업이 열렸습니다"를 읽는다
```

#### 시나리오 4.2: 키보드 팝업 닫기 [E-006]

```gherkin
Given 비디오 팝업이 표시되어 있다
  And 포커스가 팝업 내부에 있다
When 사용자가 Escape 키를 누른다
Then 비디오 팝업이 닫힌다
  And 포커스가 원래 상품 카드로 복원된다
  And 스크린 리더가 "비디오 팝업이 닫혔습니다"를 읽는다
```

#### 시나리오 4.3: 포커스 트랩

```gherkin
Given 비디오 팝업이 표시되어 있다
  And 팝업 내 마지막 요소에 포커스가 있다
When 사용자가 Tab 키를 누른다
Then 포커스가 팝업 내 첫 번째 요소로 이동한다
  And 포커스가 팝업 외부로 나가지 않는다
```

#### 시나리오 4.4: 스크린 리더 지원

```gherkin
Given 스크린 리더가 활성화되어 있다
When 비디오 팝업이 표시된다
Then 팝업이 role="dialog"를 가진다
  And 팝업이 aria-modal="true"를 가진다
  And 비디오가 "{상품명} 미리보기 비디오" aria-label을 가진다
```

#### 시나리오 4.5: Reduced Motion 지원 [O-005]

```gherkin
Given 시스템이 reduced-motion 설정이다
When 비디오 팝업이 표시되거나 숨겨진다
Then 애니메이션 없이 즉시 표시/숨김 처리된다
  And duration이 0ms로 적용된다
```

#### 시나리오 4.6: 비디오 키보드 제어

```gherkin
Given 비디오 팝업이 표시되어 있다
  And 비디오에 포커스가 있다
When 사용자가 Space 키를 누른다
Then 비디오가 일시정지/재생 토글된다

When 사용자가 M 키를 누른다
Then 비디오 음소거가 토글된다
```

---

### 5. 모바일 시나리오 [AC-MOBILE]

#### 시나리오 5.1: 모바일 탭 열기 [E-004]

```gherkin
Given 사용자가 모바일 기기(< 640px)를 사용한다
When 사용자가 상품 카드를 탭한다
Then 비디오 팝업이 표시된다
  And 비디오가 자동 재생된다
```

#### 시나리오 5.2: 모바일 탭 닫기 [E-004]

```gherkin
Given 모바일에서 비디오 팝업이 표시되어 있다
When 사용자가 팝업 외부를 탭한다
Then 비디오 팝업이 닫힌다
```

#### 시나리오 5.3: 모바일 팝업 크기

```gherkin
Given 사용자가 모바일 기기(< 640px)를 사용한다
When 비디오 팝업이 표시된다
Then 팝업 크기가 280x497px이다
  And 팝업이 화면 중앙에 표시된다
```

#### 시나리오 5.4: 태블릿 인터랙션

```gherkin
Given 사용자가 태블릿 기기(640px - 1024px)를 사용한다
When 사용자가 상품 카드를 터치한다
Then 비디오 팝업이 표시된다
  And 팝업 크기가 300x533px이다
```

---

### 6. 성능 시나리오 [AC-PERF]

#### 시나리오 6.1: 팝업 표시 속도

```gherkin
Given 사용자가 상품 카드를 호버했다
  And 300ms 딜레이가 완료되었다
When 팝업 표시 명령이 실행된다
Then 팝업이 100ms 이내에 화면에 표시된다
  And 사용자가 지연을 느끼지 않는다
```

#### 시나리오 6.2: 비디오 첫 프레임 로딩

```gherkin
Given 비디오 팝업이 표시되었다
  And HLS 스트림 연결이 시작되었다
When 비디오 로딩이 시작된다
Then 첫 번째 프레임이 1초 이내에 표시된다
  And Time to First Frame이 1000ms 미만이다
```

#### 시나리오 6.3: 메모리 관리

```gherkin
Given 10개의 상품 팝업을 연속으로 열고 닫았다
When 메모리 사용량을 측정한다
Then 추가 메모리 사용량이 50MB를 초과하지 않는다
  And 메모리 누수가 발생하지 않는다
```

#### 시나리오 6.4: CPU 사용률

```gherkin
Given 비디오가 재생 중이다
When CPU 사용률을 측정한다
Then CPU 사용률이 10%를 초과하지 않는다
  And UI가 부드럽게 반응한다 (60fps)
```

#### 시나리오 6.5: 번들 크기 영향

```gherkin
Given VideoPopup 컴포넌트가 구현되었다
When 프로덕션 빌드를 생성한다
Then 해당 컴포넌트로 인한 번들 크기 증가가 30KB 이하이다 (gzip)
```

---

## 품질 게이트 기준

### 기능 완성도

| 항목 | 기준 | 통과 조건 |
|------|------|-----------|
| 호버 팝업 | 모든 E-* 요구사항 | 100% 구현 |
| 비디오 재생 | HLS 스트리밍 | 모든 지원 브라우저 |
| 에러 처리 | 모든 UW-* 요구사항 | 100% 구현 |
| 반응형 | 3개 브레이크포인트 | 모두 동작 |

### 테스트 커버리지

| 유형 | 최소 기준 |
|------|-----------|
| 단위 테스트 | 80% 이상 |
| 컴포넌트 테스트 | 모든 주요 컴포넌트 |
| E2E 테스트 | 핵심 시나리오 5개 이상 |
| 접근성 테스트 | axe-core 0 violations |

### 성능 기준

| 메트릭 | 목표 | 측정 도구 |
|--------|------|-----------|
| 팝업 표시 시간 | < 100ms | Performance API |
| 비디오 첫 프레임 | < 1초 | 비디오 이벤트 |
| 메모리 사용량 | < 50MB | Chrome DevTools |
| CPU 사용률 | < 10% | Performance Monitor |
| 번들 크기 | < 30KB (gzip) | webpack-bundle-analyzer |

### 접근성 기준

| 항목 | 기준 |
|------|------|
| WCAG 수준 | AA 준수 |
| 키보드 접근성 | 모든 기능 사용 가능 |
| 색상 대비 | 4.5:1 이상 |
| 스크린 리더 | NVDA, VoiceOver 호환 |

---

## 검증 방법 및 도구

### 테스트 도구

| 도구 | 용도 |
|------|------|
| Vitest | 단위 테스트 |
| React Testing Library | 컴포넌트 테스트 |
| Playwright | E2E 테스트 |
| axe-core | 접근성 자동 검사 |
| Lighthouse | 성능 측정 |
| Chrome DevTools | 메모리/CPU 프로파일링 |

### 수동 테스트 체크리스트

| 카테고리 | 체크 항목 |
|----------|-----------|
| 호버 동작 | 300ms 딜레이 확인 |
| | 빠른 호버 시 팝업 미표시 확인 |
| | 마우스 이탈 시 팝업 닫힘 확인 |
| 비디오 | 자동 재생 확인 |
| | 음소거 상태 확인 |
| | 반복 재생 확인 |
| 위치 | 우측 배치 확인 |
| | 경계 시 좌측 배치 확인 |
| 접근성 | Tab 키로 탐색 |
| | Enter로 팝업 열기 |
| | Escape로 팝업 닫기 |
| 모바일 | 탭으로 열기/닫기 |
| | 외부 탭으로 닫기 |

---

## Definition of Done (완료 정의)

### 코드 완료

- 모든 컴포넌트 구현 완료
- TypeScript 타입 정의 완료
- ESLint/Prettier 검사 통과
- 코드 리뷰 완료

### 테스트 완료

- 단위 테스트 80% 이상 커버리지
- 모든 시나리오 테스트 통과
- 접근성 자동 검사 통과
- 크로스 브라우저 테스트 완료

### 성능 검증

- 모든 성능 메트릭 목표 달성
- 메모리 누수 없음 확인
- 번들 크기 영향 확인

### 문서화

- 컴포넌트 API 문서 작성
- 사용 예제 작성
- Storybook 스토리 추가 (해당 시)

### 배포 준비

- 스테이징 환경 테스트 완료
- 프로덕션 빌드 성공
- 배포 체크리스트 완료
